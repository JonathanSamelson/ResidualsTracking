# ResidualsTracking: Matlab Adaptive Block Matching Algorithm (ABMA) code

This readme will guide you to obtain the residual frames from a set of sucessive decoded frames.


## Guidelines

- The input video should be seperated into a set of 'n' successive decoded frames in .bmp .png or .jpg format.
- The default input naming format should be 'xxxxxx1.bmp','xxxxxx2.bmp', etc.
- The output will be a set of 'n-1' sucessive decoded frames in bmp .png or .jpg format.
- The output will be placed set of 'n-1' sucessive decoded frames in bmp .png or .jpg format.
- The minimum input frame size should of 384*384.
- The subfunction matlab files should be placed in the same directory as `main_ABMA_clustering.m'.
- Optional: The code can also output the individual motion vectors as well as the ABMA heat map associated with each individual residual frame.



## Parameters

- It should be noted that the ABMA in this code is fixed from a 128*128 maximum block size to a 4*4 minimum block size.

The parameters used to generate the results of our paper are set by default. You will find them at the top of `main_ABMA_clustering.m`.

Here is a description of the main flexible parameters that were used:

| Parameter | Description | Default
| -----------| ------------ | -------- |
| start_frame_number | Indicate the starting frame number | 1
| end_frame_number | Indicate the ending frame number | 1000
| fps_latency_fromoriginal | Indicate the sampling rate between two sucessive decoded frames | 1
| image_row_org | Input image length rounded up to the nearest multiple of 128 | 1152
| image_col_org | Input image width rounded up to the nearest multiple of 128 | 1920
| sensitivity_limit_128 | ABMA splitting threshold for 128*128 block size |3
| sensitivity_limit_64 | ABMA splitting threshold for 64*64 block size | 10
| sensitivity_limit_32 | ABMA splitting threshold for 32*32 block size | 20
| sensitivity_limit_16 | ABMA splitting threshold for 16*16 block size | 50
| sensitivity_limit_16 | ABMA splitting threshold for 8*8 block size | 70
| sensitivity_limit_16 | ABMA splitting threshold for 4*4 block size | 100


## Additional Notes

- Regions of interests (ROI) can be extracted from `main_ABMA_clustering.m` based on the movement between two successive evaluated decoded frames. 'imgI_withBlockContour_display' displays the original decoded frame covered by coutours of each individual block generated by the ABMA. 'imgI_MovementAreas_withBlockContour_display' highlights the same contouring in a heat map format.
